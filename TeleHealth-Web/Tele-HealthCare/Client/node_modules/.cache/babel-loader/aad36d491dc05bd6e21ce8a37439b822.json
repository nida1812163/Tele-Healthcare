{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\abidh\\\\OneDrive\\\\Desktop\\\\Final FYP\\\\Final FYP\\\\official Tele-HealthCare\\\\Client\\\\src\\\\Videocalling\\\\VideoCall.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport { config, useClient, useMicrophoneAndCameraTracks, channelName } from \"./settings.js\";\nimport { Grid } from \"@material-ui/core\";\nimport Video from \"./Video\";\nimport Controls from \"./Controls\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function VideoCall(props) {\n  _s();\n\n  const {\n    setInCall\n  } = props;\n  const [users, setUsers] = useState([]);\n  const [start, setStart] = useState(false);\n  const client = useClient();\n  const {\n    ready,\n    tracks\n  } = useMicrophoneAndCameraTracks();\n  useEffect(() => {\n    let init = async name => {\n      await client.join(config.appId, name, config.token, null);\n      client.on(\"user-published\", async (user, mediaType) => {\n        await client.subscribe(user, mediaType);\n\n        if (mediaType === \"video\") {\n          setUsers(prevUsers => {\n            return [...prevUsers, user];\n          });\n        }\n\n        if (mediaType === \"audio\") {\n          user.audioTrack.play();\n        }\n      });\n      client.on(\"user-unpublished\", (user, mediaType) => {\n        if (mediaType === \"audio\") {\n          if (user.audioTrack) user.audioTrack.stop();\n        }\n\n        if (mediaType === \"video\") {\n          setUsers(prevUsers => {\n            return prevUsers.filter(User => User.uid !== user.uid);\n          });\n        }\n      });\n      client.on(\"user-left\", user => {\n        setUsers(prevUsers => {\n          return prevUsers.filter(User => User.uid !== user.uid);\n        });\n      }); // try {\n      //   await client.join(config.appId, name, config.token, null);\n      // } catch (error) {\n      //   console.log(\"error\");\n      // }\n\n      if (tracks) await client.publish([tracks[0], tracks[1]]);\n      setStart(true);\n    };\n\n    if (ready && tracks) {\n      try {\n        init(channelName);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }, [channelName, client, ready, tracks]);\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    direction: \"column\",\n    style: {\n      height: \"100%\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      style: {\n        height: \"5%\"\n      },\n      children: ready && tracks && /*#__PURE__*/_jsxDEV(Controls, {\n        tracks: tracks,\n        setStart: setStart,\n        setInCall: setInCall\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      style: {\n        height: \"95%\"\n      },\n      children: start && tracks && /*#__PURE__*/_jsxDEV(Video, {\n        tracks: tracks,\n        users: users\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 29\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}\n\n_s(VideoCall, \"bVqyhft+oHPVFk+rZRgMDn8xJiw=\", false, function () {\n  return [useClient, useMicrophoneAndCameraTracks];\n});\n\n_c = VideoCall;\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoCall\");","map":{"version":3,"sources":["C:/Users/abidh/OneDrive/Desktop/Final FYP/Final FYP/official Tele-HealthCare/Client/src/Videocalling/VideoCall.js"],"names":["useState","useEffect","config","useClient","useMicrophoneAndCameraTracks","channelName","Grid","Video","Controls","VideoCall","props","setInCall","users","setUsers","start","setStart","client","ready","tracks","init","name","join","appId","token","on","user","mediaType","subscribe","prevUsers","audioTrack","play","stop","filter","User","uid","publish","error","console","log","height"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport {\n  config,\n  useClient,\n  useMicrophoneAndCameraTracks,\n  channelName,\n} from \"./settings.js\";\nimport { Grid } from \"@material-ui/core\";\nimport Video from \"./Video\";\nimport Controls from \"./Controls\";\n\nexport default function VideoCall(props) {\n  const { setInCall } = props;\n  const [users, setUsers] = useState([]);\n  const [start, setStart] = useState(false);\n  const client = useClient();\n  const { ready, tracks } = useMicrophoneAndCameraTracks();\n\n  useEffect(() => {\n    let init = async (name) => {\n      await client.join(config.appId, name, config.token, null)\n      \n      client.on(\"user-published\", async (user, mediaType) => {\n        await client.subscribe(user, mediaType);\n        if (mediaType === \"video\") {\n          setUsers((prevUsers) => {\n            return [...prevUsers, user];\n          });\n        }\n        if (mediaType === \"audio\") {\n          user.audioTrack.play();\n        }\n      });\n\n      client.on(\"user-unpublished\", (user, mediaType) => {\n        if (mediaType === \"audio\") {\n          if (user.audioTrack) user.audioTrack.stop();\n        }\n        if (mediaType === \"video\") {       \n          setUsers((prevUsers) => {\n            return prevUsers.filter((User) => User.uid !== user.uid);\n          });\n        }\n      });\n\n      client.on(\"user-left\", (user) => {\n        setUsers((prevUsers) => {\n          return prevUsers.filter((User) => User.uid !== user.uid);\n        });\n      });\n\n      // try {\n      //   await client.join(config.appId, name, config.token, null);\n      // } catch (error) {\n      //   console.log(\"error\");\n      // }\n\n      if (tracks) await client.publish([tracks[0], tracks[1]]);\n      setStart(true);\n    };\n\n    if (ready && tracks) {\n      try {\n        init(channelName);\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }, [channelName, client, ready, tracks]);\n\n  return (\n    <Grid container direction=\"column\" style={{ height: \"100%\" }}>\n      <Grid item style={{ height: \"5%\" }}>\n        {ready && tracks && (\n          <Controls tracks={tracks} setStart={setStart} setInCall={setInCall} />\n        )}\n      </Grid>\n      <Grid item style={{ height: \"95%\" }}>\n        {start && tracks && <Video tracks={tracks} users={users} />}\n      </Grid>\n    </Grid>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}